{% set version = "1.9.5" %}

package:
  name: geoviews-core
  version: {{ version }}

source:
  url: https://github.com/holoviz/geoviews/archive/v{{ version }}.tar.gz
  sha256: fe2afdac9b366f986caf6107c1cd93ba4a9e9130032c893c5dea03d2e444e1fc

build:
  number: 0
  # nodejs and cartopy aren't available on s390x
  skip: True  # [s390x]

outputs:
  - name: geoviews-core
    script: build_base.sh
    build:
      skip: True  # [py<37]
      entry_points:
        - geoviews = geoviews.__main__:main
    requirements:
      run_constrained:
        - geoviews {{ version }}
      host:
        - python
        - pip
        - param
        # These are also needed at build time and declared in the pyproject.toml
        - pyct
        # geoviews isn't compatible with bokeh >=3.0.0
        - bokeh >=2.4.0,<2.5.0
        - nodejs
        - wheel
        - cartopy
        - setuptools
      run:
        - python
        - bokeh >=2.4.0,<2.5.0
        - cartopy >=0.18.0
        - holoviews >=1.14.2
        - numpy  >=1.0
        - packaging
        - param >=1.9.3
    test:
      requires:
        - pip
      commands:
        - pip check
      imports:
        - geoviews

  - name: geoviews
    build:
      skip: True  # [py<37]
    requirements:
      run:
        - python
        - {{ pin_subpackage('geoviews-core', exact=True) }}
        - bokeh >=2.4.0,<2.5.0
        - cartopy >=0.18.0
        - datashader
        - geopandas-base
        - holoviews >=1.14.2
        - netcdf4
        - numpy >=1.0
        - pandas
        - param >=1.9.3,<2.0
        - pyct
        - xarray
    test:
      imports:
        - geoviews
      requires:
        - nbsmoke
        - pytest
      commands:
        - geoviews examples --path=. --force
        # just run one notebook for now; increase in the future if notebooks can be run quickly with test/tiny data
        - pytest --nbsmoke-run -k ".ipynb" user_guide/Projections.ipynb
    about:
      home: https://geoviews.org
      license: BSD-3-Clause
      license_family: BSD
      license_file: LICENSE
      summary: GeoViews is a Python library that makes it easy to explore and visualize geographical, meteorological, and oceanographic datasets, such as those used in weather, climate, and remote sensing research.

about:
  home: https://geoviews.org
  license: BSD-3-Clause
  license_family: BSD
  license_file: LICENSE
  summary: GeoViews is a Python library that makes it easy to explore and visualize geographical, meteorological, and oceanographic datasets, such as those used in weather, climate, and remote sensing research.
  description: |
    GeoViews is a Python library that makes it easy to explore and visualize geographical, meteorological, and oceanographic datasets, such as those used in weather, climate, and remote sensing research.
    GeoViews is built on the HoloViews library for building flexible visualizations of multidimensional data. GeoViews adds a family of geographic plot types based on the Cartopy library, plotted using either the Matplotlib or Bokeh packages. With GeoViews, you can now work easily and naturally with large, multidimensional geographic datasets, instantly visualizing any subset or combination of them, while always being able to access the raw data underlying any plot.
  doc_url: https://geoviews.org/index.html
  dev_url: https://github.com/holoviz/geoviews

extra:
  recipe-maintainers:
    - ocefpaf
    - philippjfr